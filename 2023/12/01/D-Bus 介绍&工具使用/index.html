<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>D-Bus_介绍&amp;工具使用 - XinCm</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="XinCm"><meta name="msapplication-TileImage" content="/img/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="XinCm"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="DBUS，数据总线，是一个低延迟，低开销，高可用性的ipc机制。在D-Bus中，“bus”是核心的概念，它是一个通道：不同的程序可以通过这个通道做些操作，比如方法调用、发送信号和监听特定的信号。在一台机器上总线守护有多个实例(instance)。这些总线之间都是相互独立的。"><meta property="og:type" content="blog"><meta property="og:title" content="D-Bus_介绍&amp;工具使用"><meta property="og:url" content="http://example.com/2023/12/01/D-Bus%20%E4%BB%8B%E7%BB%8D&amp;%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="XinCm"><meta property="og:description" content="DBUS，数据总线，是一个低延迟，低开销，高可用性的ipc机制。在D-Bus中，“bus”是核心的概念，它是一个通道：不同的程序可以通过这个通道做些操作，比如方法调用、发送信号和监听特定的信号。在一台机器上总线守护有多个实例(instance)。这些总线之间都是相互独立的。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/images/D-Bus_%E4%BB%8B%E7%BB%8D&amp;%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/1.png"><meta property="article:published_time" content="2023-12-01T06:02:04.066Z"><meta property="article:modified_time" content="2023-12-01T06:02:04.066Z"><meta property="article:author" content="lx"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/images/D-Bus_%E4%BB%8B%E7%BB%8D&amp;%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/1.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2023/12/01/D-Bus%20%E4%BB%8B%E7%BB%8D&%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"},"headline":"D-Bus_介绍&工具使用","image":["http://example.com/images/D-Bus_%E4%BB%8B%E7%BB%8D&%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/1.png"],"datePublished":"2023-12-01T06:02:04.066Z","dateModified":"2023-12-01T06:02:04.066Z","author":{"@type":"Person","name":"lx"},"publisher":{"@type":"Organization","name":"XinCm","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.png"}},"description":"DBUS，数据总线，是一个低延迟，低开销，高可用性的ipc机制。在D-Bus中，“bus”是核心的概念，它是一个通道：不同的程序可以通过这个通道做些操作，比如方法调用、发送信号和监听特定的信号。在一台机器上总线守护有多个实例(instance)。这些总线之间都是相互独立的。"}</script><link rel="canonical" href="http://example.com/2023/12/01/D-Bus%20%E4%BB%8B%E7%BB%8D&amp;%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"><link rel="icon" href="/img/logo.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="XinCm" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="XinCm" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/XinCm"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-12-01T06:02:04.066Z" title="12/1/2023, 2:02:04 PM">2023-12-01</time>发表</span><span class="level-item"><time dateTime="2023-12-01T06:02:04.066Z" title="12/1/2023, 2:02:04 PM">2023-12-01</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a></span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">D-Bus_介绍&amp;工具使用</h1><div class="content"><blockquote>
<p>DBUS，数据总线，是一个低延迟，低开销，高可用性的ipc机制。<br>在D-Bus中，“bus”是核心的概念，它是一个通道：不同的程序可以通过这个通道做些操作，比如方法调用、发送信号和监听特定的信号。在一台机器上总线守护有多个实例(instance)。这些总线之间都是相互独立的。</p>
</blockquote>
<span id="more"></span>
<h1 id="一、D-Bus简介"><a href="#一、D-Bus简介" class="headerlink" title="一、D-Bus简介"></a>一、D-Bus简介</h1><p><img src="/images/D-Bus_%E4%BB%8B%E7%BB%8D&%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/1.png"></p>
<h2 id="1、D-Bus简介"><a href="#1、D-Bus简介" class="headerlink" title="1、D-Bus简介"></a>1、D-Bus简介</h2><p>D-Bus是Desktop Bus的缩写，是针对桌面环境优化的IPC(InterProcess Communication)机制，用于进程间的通信或进程与内核的通信。<br>D-Bus是为Linux系统开发的进程间通信（IPC）和远程过程调用（RPC）机制，使用统一的通信协议来代替现有的各种IPC解决方案。D-Bus允许系统级进程（如：打印机和硬件驱动服务）和普通用户进程进行通信。<br>D-Bus使用一个快速的二进制消息传递协议，D-Bus协议的低延迟和低消耗特点适用于同一台机器的通信。D-Bus的规范目前由freedesktop.org项目定义，可供所有团体使用。<br>D-Bus不和低层的IPC直接竞争，比如sockets，shared memory或message queues。低层IPC有自己的特点，和D-Bus并不冲突。<br>与其他重量级的进程间通信技术不同，D-Bus是非事务的。D-Bus使用了状态以及连接的概念，比UDP等底层消息传输协议更“聪明”。但另一方面，D-Bus传送的是离散消息，与TCP协议将数据看做“流”有所不同。D-Bus支持点对点的消息传递以及广播&#x2F;订阅式的通信。</p>
<h2 id="2、不同IPC通信方式比较"><a href="#2、不同IPC通信方式比较" class="headerlink" title="2、不同IPC通信方式比较"></a>2、不同IPC通信方式比较</h2><p><strong>不同IPC通信机制的特点如下：</strong></p>
<blockquote>
<p>A、CORBA是用于面向对象编程中复杂IPC的一个强大的解决方案。<br>B、Bonobo是一个只用于GNOME的解决方案，基于CORBA并依赖于GObject。<br>C、DCOP是一个较轻量级的IPC框架，功能较少，但可以很好地集成到KDE桌面环境中。<br>D、SOAP和XML-RPC设计用于Web服务，因而使用HTTP作为其传输协议。<br>E、D-BUS设计用于桌面应用程序和OS通信。</p>
</blockquote>
<h2 id="3、D-Bus特性"><a href="#3、D-Bus特性" class="headerlink" title="3、D-Bus特性"></a>3、D-Bus特性</h2><blockquote>
<p>A、D-BUS的协议是低延迟而且低开销的，设计小巧且高效，以便最小化传送时间。从设计上避免往返交互并允许异步操作。<br>B、协议是二进制的，而不是文本，排除序列化过程。<br>C、考虑了字节序问题。<br>D、易用性：按照消息而不是字节流来工作，并且自动地处理了许多困难的IPC问题，并且D-Bus库以可以封装的方式来设计，开发者可以使用框架里存在的对象&#x2F;类型系统，而不用学习一种新的专用于IPC的对象&#x2F;类型系统。<br>E、请求时启动服务以及安全策略。<br>F、支持多语言（C&#x2F;C++&#x2F;Java&#x2F;C#&#x2F;Python&#x2F;Ruby），多平台(Linux&#x2F;windows&#x2F;maemo)。<br>G、采用C语言，而不是C++。<br>H、由于基本上不用于internet上的IPC，因此对本地IPC进行了特别优化。<br>I、提供服务注册，理论上可以进行无限扩展。</p>
</blockquote>
<h1 id="二、D-Bus架构"><a href="#二、D-Bus架构" class="headerlink" title="二、D-Bus架构"></a>二、D-Bus架构</h1><h2 id="1、D-Bus架构简介"><a href="#1、D-Bus架构简介" class="headerlink" title="1、D-Bus架构简介"></a>1、D-Bus架构简介</h2><p><strong>D-Bus是按一定的层次结构实现的，总体上D-Bus分为三层：</strong><br>A、接口层——接口层由libdbus库提供，进程通过libdbus库使用D-Bus的能力。通过底层库的接口可以实现两个进程之间进行连接并发送消息。<br>B、总线层——由消息总线守护进程(message bus daemon )提供，消息总线守护进程是基于libdbus底层库的，可以路由消息。消息总线守护进程负责进程间的消息路由和传递，其中包括Linux内核和Linux桌面环境的消息传递。<br>C、封装层——封装层是一系列基于特定应用程序框架的Wrapper库，将D-Bus底层接口封装成方便用户使用的通用API。</p>
<blockquote>
<p>A、接口层——接口层由libdbus库提供，进程通过libdbus库使用D-Bus的能力。通过底层库的接口可以实现两个进程之间进行连接并发送消息。<br>B、总线层——由消息总线守护进程(message bus daemon )提供，消息总线守护进程是基于libdbus底层库的，可以路由消息。消息总线守护进程负责进程间的消息路由和传递，其中包括Linux内核和Linux桌面环境的消息传递。<br>C、封装层——封装层是一系列基于特定应用程序框架的Wrapper库，将D-Bus底层接口封装成方便用户使用的通用API。</p>
</blockquote>
<h2 id="2、D-Bus接口层"><a href="#2、D-Bus接口层" class="headerlink" title="2、D-Bus接口层"></a>2、D-Bus接口层</h2><p>libdbus只支持点对点的通信，即只支持一进程与另外的一个进程进行通信。通信是基于消息的，消息包含头部和消息体。<br>libdbus提供C语言的底层API，API是为了将D-Bus绑定到特定的对象或是语言而设计的，官方文档中建议不要在应用上直接使用D-Bus的底层接口，推荐使用D-Bus的绑定，如QtDBus、GDBus、dbus-c++等实现。</p>
<h2 id="3、D-Bus总线层"><a href="#3、D-Bus总线层" class="headerlink" title="3、D-Bus总线层"></a>3、D-Bus总线层</h2><p>D-Bus总线层由消息总线守护进程(message bus daemon )提供。消息总线守护进程是一个后台进程,是&#x2F;usr&#x2F;bin&#x2F;dbus-daemon的一个运行实例, 负责消息的转发，dbus-daemon运行时会调用libdus的库。应用程序调用特定的应用程序框架的Wrapper库与dbus-daemon进行通信。应用程序通过D-Bus与其它进程通信必须先建立到消息总线守护进程实例的连接。<br>最常见的基于dbus的程序也符合C&#x2F;S结构。比如开发两个程序A和B，其中A是客户端，B是服务端。假设A要调用B的一个函数func，那么实际的消息流动方向是：A告诉dbus-daemon请求要调用B的func函数，然后dbus-daemon去调用B的func函数，如果func有返回值的话，B会把返回值告诉dbus-daemon，然后dbus- daemon再把返回值告诉A。如果B进程还没有启动，则dbus-daemon会自动的先把B进程启动起来。<br>通常情况下，Linux会有两个dbus-daemon进程，一个属于system，一个属于session，在用户登录的时候由dbus-launch启动。<br>大多数普通程序，都是使用session的dbus-daemon，默认情况下，A就是将消息发给属于session的dbus-daemon。<br>dbus-daemon是有地址的，环境变量DBUS_SESSION_BUS_ADDRESS用于表示当前登录用户的session的dbus-daemon进程的地址，可以使用下面命令查看。</p>
<blockquote>
<p>zyb@zyb:~$ echo $DBUS_SESSION_BUS_ADDRESS<br>unix:abstract&#x3D;&#x2F;tmp&#x2F;dbus-7BEdWvxPGx</p>
</blockquote>
<p>当用户登录进桌面环境的时候，系统启动脚本会调用到dbus-launch来启动一个dbus-daemon进程，同时会把启动的dbus-daemon地址赋予环境变量DBUS_SESSION_BUS_ADDRESS。<br>一般情况下，不需要考虑DBUS_SESSION_BUS_ADDRESS，但某些时候，单独启动一个dbus-daemon有助于程序的调试。<br>利用dbus-daemon自启动机制运行的服务进程，都是后台进程，标准输出设备已经被重定向，如果B进程有一些调试用的打印信息输出，则很难直接查看。此时，可以单独启动一个dbus-daemon，让A和B都使用自己启动的dbus-daemon，此时，dbus-daemon能把B的打印信息显示出来。<br><strong>先在终端下启动一个dbus-daemon，命令如下形式如下：</strong></p>
<blockquote>
<p>zyb@zyb:~$ DBUS_VERBOSE&#x3D;1 dbus-daemon –session –print-address<br>unix:abstract&#x3D;&#x2F;tmp&#x2F;dbus-uA3iIEfO1Z,guid&#x3D;4c58483b0f9112cb98abd34062287954</p>
</blockquote>
<p>如此启动的dbus-daemon会前台执行，并且打印出地址。然后，在执行A程序的时候，设置环境变量DBUS_SESSION_BUS_ADDRESS为刚才得到的地址值。</p>
<blockquote>
<p>DBUS_SESSION_BUS_ADDRESS&#x3D;unix:abstract&#x3D;&#x2F;tmp&#x2F;dbus-uA3iIEfO1Z,guid&#x3D;4c58483b0f9112cb98abd34062287954 .&#x2F;A</p>
</blockquote>
<p>此时运行程序A和B，使用自己启动的dbus-daemon来转发消息，并且会把B的打印信息显示出来。<br>消息总线守护进程是一个特殊的进程，用于管理系统内的总线，可以将一个进程的消息路由给另外一个进程。如果有很多应用程序连接到消息总线守护进程的总线上，总线能把消息路由到对应的一个或多个进程中去。因此在总线层上，实现了点对点通信的支持，也实现了广播&#x2F;订阅通信方式。<br>在最底层，D-Bus只支持点对点的通信，一般使用本地套接字(AF_UNIX)在应用和消息总线守护进程之间通信。D-Bus的点对点是经过bus daemon抽象过的，由bus daemon来完成寻址和发送消息，因此每个应用不必关心要把消息发给哪个进程。</p>
<h3 id="D-Bus发送消息通常包含如下步骤："><a href="#D-Bus发送消息通常包含如下步骤：" class="headerlink" title="D-Bus发送消息通常包含如下步骤："></a>D-Bus发送消息通常包含如下步骤：</h3><blockquote>
<p>A、应用程序创建和发送消息给消息总线守护进程。<br>B、消息总线守护进程对收到的消息进行分发处理。<br>C、目标程序接收到消息，然后根据消息的种类，做不同的响应：确认、应答、忽略。</p>
</blockquote>
<p>总线是D-Bus的进程间通信机制，一个系统中通常存在多条总线，总线由D-Bus总线守护进程管理。<br>最重要的总线为系统总线（System Bus），Linux内核引导时，系统总线就已被装入内存。只有Linux内核、Linux桌面环境和权限较高的程序才能向系统总线写入消息，以此保障系统安全性，防止有恶意进程假冒Linux发送消息。<br>会话总线（Session Buses）由普通进程创建，可同时存在多条。会话总线属于某个进程私有，用于进程间传递消息。</p>
<h2 id="4、D-Bus封装层"><a href="#4、D-Bus封装层" class="headerlink" title="4、D-Bus封装层"></a>4、D-Bus封装层</h2><p>D-Bus封装层是将libdbus底层API绑定到特定的对象系统或是语言中，將不便使用的libdbus底层API封裝成可以在应用层使用的高級API，如libdbus-glib、libdbus-qt等。<br>D-Bus在很多不同的编程语言上都有其接口实现。不同语言的接口封装了D-Bus低级API，提供了更符合编程语言的语法结构。<br>实现D-Bus接口的语言正在逐渐增加。在C语言中，有最底层的API，但其实现及使用上非常复杂。C语言中另一个实用化的实现基于GLib。在Java、Perl、Python等都有D-Bus接口实现。</p>
<h1 id="三、D-Bus术语"><a href="#三、D-Bus术语" class="headerlink" title="三、D-Bus术语"></a>三、D-Bus术语</h1><h2 id="1、D-Bus术语简介"><a href="#1、D-Bus术语简介" class="headerlink" title="1、D-Bus术语简介"></a>1、D-Bus术语简介</h2><p>总线是消息总线守护进程(message bus daemon)的运行实例，每个总线都有一个地址，应用进程就是通过总线地址和相应的总线连接的。总线上的每一个连接都有一个连接名，连接名也称bus name。每个连接上有至少一个对象，通常有多个对象，对象使用对象路径唯一标识。对象要实现一个或多个接口，每个接口包含一组方法和信号。</p>
<h2 id="2、总线（Bus）"><a href="#2、总线（Bus）" class="headerlink" title="2、总线（Bus）"></a>2、总线（Bus）</h2><p>在D-Bus中，总线(bus)是核心的概念：不同的程序可以通过总线进行某些操作，比如方法调用、发送信号和监听特定的信号。总线通常有两种，系统总线(system bus)和会话总线(session bus)，系统总线通常只有一条，用户总线在用户登录时创建。<br>系统总线是一个持久的总线，在系统启动时就创建，供系统内核和后台进程使用，具有较高的安全性。系统总线最常用是发送系统消息，比如：插入一个新的存储设备、有新的网络连接等。<br>会话总线是在某个用户登录后启动，属于某个用户私有，是某用户的应用程序用来通话的通道。在很多嵌入式系统中，只有一个用户ID登录运行，因此只有一个会话总线。<br>一条消息总线就是一个消息路由器，是消息总线守护进程(message bus daemon)的一个实例。</p>
<h2 id="3、地址-Address"><a href="#3、地址-Address" class="headerlink" title="3、地址(Address)"></a>3、地址(Address)</h2><p>使用d-bus的应用程序既可以是server端也可以是client端，server端监听到来的连接，client端连接到server端，一旦连接建立，消息就可以流转。如果使用dbus daemon，所有的应用程序都是client端，dbus daemon监听所有的连接，应用程序初始化连接到dbus daemon。<br>每一条总线都有一个地址，进程通过总线的地址连接到总线上。一个D-Bus的地址是指server端用于监听，client端将要连接的地方，例如unix:path&#x3D;&#x2F;tmp&#x2F;abcedf标识server端将在路径&#x2F;tmp&#x2F;abcedf的UNIX domain socket监听，client端将要连接到这个地址。地址可以是指定的TCP&#x2F;IP socket或者其他在或者将在D-Bus协议中定义的传输方式。<br>如果使用bus daemon，libdbus将通过读取环境变量DBUS_SESSION_BUS_ADDRESS自动获取session bus damon的地址，通过检查一个指定的UNIX domain socket路径获取system bus的地址。<br>如果使用D-bus，但不是daemon，需要定义哪个应用是server端，哪个是client端，并定义一套机制用于认可server端的地址。</p>
<h2 id="4、连接名-Bus-Name"><a href="#4、连接名-Bus-Name" class="headerlink" title="4、连接名(Bus Name)"></a>4、连接名(Bus Name)</h2><p>总线上的每个连接都有一个或多个名字。当连接建立以后，D-Bus 服务会分配一个不可改变的连接名，称为唯一连接名(unique connection name)，唯一连接名即使在进程结束后也不会再被其他进程所使用。<br>唯一连接名以冒号开头，如“:34-907”。但唯一连接名总是临时分配，无法确定，也难以记忆，因此应用可以要求有另外一个名字公共名(well-known name)来对应唯一连接名。例如可以使用“com.mycompany”来映射“:34-907”。应用程序可能会要求拥有额外的公共名(well-known name)。例如，可以写一个规范来定义一个名字叫做 com.mycompany.TextEditor。协议可以指定自己拥有名字为com.mycompany.TextEditor的连接，一个路径为&#x2F;com&#x2F;mycompany&#x2F;TextFileManager的对象，对象拥有接口org.freedesktop.FileHandler。应用程序就可以发送消息到总线上的连接名字，对象和接口以执行方法调用。</p>
<p>连接名可以用于跟踪应用程序的生命周期。当应用退出（或者崩溃）时，与总线的连接将被OS内核关掉，总线将会发送通知，告诉剩余的应用程序。</p>
<h2 id="5、对象和对象路径-Object-and-Object-Path"><a href="#5、对象和对象路径-Object-and-Object-Path" class="headerlink" title="5、对象和对象路径(Object and Object Path)"></a>5、对象和对象路径(Object and Object Path)</h2><p>D-Bus的对象和面向对象语言中的对象含义是不同的，D-Bus的对象表示的是D-Bus通道中信息流向的端点。对象由客户进程创建，并在连接进程中保持不变。<br>所有使用D-BUS的应用程序都包含一些对象, 当经由一个D-BUS连接收到一条消息时，消息是被发往一个对象而不是整个应用程序。应用程序框架中定义了这样的对象，如GObject，QObject等，在D-Bus中称为原生对象（native object）。<br>对于底层的D-Bus协议，即libdbus API，并不理会原生对象，使用对象路径(object path)的概念。通过对象路径，高层API接口可以绑定到对象，允许远程应用指向对象。对象路径如同文件系统路径，例如一个对象可能叫做“&#x2F;org&#x2F;kde&#x2F;kspread&#x2F;sheets&#x2F;3&#x2F;cells&#x2F;4&#x2F;5”。<br>对象路径在全局（session或者system）是唯一的，用于消息的路由。</p>
<h2 id="6、接口（Interface）"><a href="#6、接口（Interface）" class="headerlink" title="6、接口（Interface）"></a>6、接口（Interface）</h2><p>每一个对象支持一个或者多个接口，接口是一组方法和信号的集和，接口定义一个对象实体的类型。D-Bus对接口的命名方式，类似org.freedesktop.Introspectable。开发人员通常使用编程语言名字作为接口名字。</p>
<h2 id="7、方法-Methods"><a href="#7、方法-Methods" class="headerlink" title="7、方法(Methods)"></a>7、方法(Methods)</h2><p>每一个对象有两类成员：方法和信号。方法是一段函数代码，带有输入和输出；信号是广播给所有兴趣的其他实体，信号可以带有数据payload。</p>
<p>客户向某对象发送一个请求，即对象被请求执行一个明确的、有名称的动作。如果客户请求执行一个目标对象未提供的方法，将会产生一个错误。方法的定义可以支持输入参数。对于每个请求，都有一个包含请求结果以及结果数据(输出参数)的响应返回给请求者。当请求无法完成时，响应中将包含异常信息，其中至少有异常名称以及错误信息。<br>大多数语言都将这些封装在自身的语言机制中，比如将参数包装进消息包，将异常信息转换成语言自身的异常等等。在这些实现中，向远程对象传递一个字符串参数就好像是在本地执行一个字符串参数的函数一样简单。此时不再需要数据类型转换、数据复制等繁琐工作，语言本身封装了一切底层实现。</p>
<h2 id="8、信号-Signals"><a href="#8、信号-Signals" class="headerlink" title="8、信号(Signals)"></a>8、信号(Signals)</h2><p>信号依然遵从面向对象概念，信号是从对象发出但没有特定目的地址的单向数据广播。客户进程可以预先注册其感兴趣的信号，如特定名称的信号或从某个对象发出的信号等。当对象发出信号后，所有订阅了该信号的客户进程将收到此信号的复本。接收端可能有多种情况出现，或者有一个客户进程，或者有多个客户进程，或者根本没有客户进程对这个信号感兴趣。对于信号来说没有响应消息，发出信号的对象不会知道是不是有客户进程在接收，有多少客户进程接收，以及从客户进程收到任何反馈。<br>信号可以有参数。<br>但信号是单向通信，因此不可能像方法一样具有输入输出参数。D-Bus允许客户进程通过参数比对过滤其需要的信号。<br>信号一般用来广播一些客户可能会感兴趣的事件，比如某个其它的客户进程与总线的连接断开等。这些信号来自总线对象，因此从信号中客户进程可以分辨断线是由于正常退出、被杀掉或者程序崩溃。</p>
<h2 id="9、代理-Proxies"><a href="#9、代理-Proxies" class="headerlink" title="9、代理(Proxies)"></a>9、代理(Proxies)</h2><p>代理对象用来表示其他的remote object。当触发了proxy对象的method时，将会在D-Bus上发送一个method_call的消息，并等待答复，根据答复返回。<br>总线上的对象一般通过代理来访问。总线上的对象位于客户进程以外，而客户可以调用本地接口与对象通信，此时，本地接口充当了代理的角色。当触发了代理对象的方法时，将会在D-Bus上发送一个method_call的消息，并等待答复返回，就象使用一个本地对象一样。<br>一些语言的代理支持“断线重连”。比如所连接的对象在某段时间里暂时断开了与总线的连接，代理会自动重连到相同的连接名并重新找到对象，程序甚至不会知道目标对象有段时间不可用。并不是所有的语言都支持这一特性，在GLib中的两种代理中的一种支持。<br>比如不用代理时的代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Message message = new Message(<span class="string">&quot;/remote/object/path&quot;</span>, <span class="string">&quot;MethodName&quot;</span>, arg1, arg2); </span><br><span class="line">Connection connection = getBusConnection();           </span><br><span class="line">connection.send(message);           </span><br><span class="line">Message reply = connection.waitForReply(message);           </span><br><span class="line"><span class="keyword">if</span> (reply.isError()) &#123;                         </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;              </span><br><span class="line">     Object returnValue = reply.getReturnValue();           </span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure>
<p>采用代理时对应的代码则是：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Proxy proxy = new Proxy(getBusConnection(), <span class="string">&quot;/remote/object/path&quot;</span>);      </span><br><span class="line">Object returnValue = proxy.MethodName(arg1, arg2);</span><br></pre></td></tr></table></figure>
<h2 id="10、服务"><a href="#10、服务" class="headerlink" title="10、服务"></a>10、服务</h2><p>服务是 D-BUS 的最高层次抽象，服务的实现当前还在不断发展变化。应用程序可以通过一个总线来注册一个服务，如果成功，则应用程序就已经获得了服务。其他应用程序可以检查在总线上是否已经存在一个特定的服务，如果没有可以要求总线启动它。<br>当通过总线进行通信时，应用程序会获取服务名称。服务名称是应用程序如何选择同一总线上的其他应用程序的依据。服务名称由总线守护进程进行代理，用于将消息从一个应用程序路由到另一个应用程序。服务名称的类似概念是IP地址和主机名：计算机通常具有一个IP地址，并且根据其向网络提供的服务，可以具有与之相关联的一个或多个主机名。<br>另一方面，如果不使用总线，服务名称也不会使用。如果再将它与计算机网络进行比较，这将等同于点到点网络：因为对等方是已知的，所以不需要使用主机名来查找它或它的IP地址。<br>总线服务名称的格式实际上与主机名非常相似：它是字母和数字的点分隔序列。常见的做法是根据服务定义的组织的域名来命名自己的服务名称。例如，D-Bus服务由freedesktop.org定义，可以使用org.freedesktop.DBus服务名称在总线上找到它。</p>
<h1 id="四、消息和消息总线"><a href="#四、消息和消息总线" class="headerlink" title="四、消息和消息总线"></a>四、消息和消息总线</h1><h2 id="1、消息简介"><a href="#1、消息简介" class="headerlink" title="1、消息简介"></a>1、消息简介</h2><p>D-Bus通信机制是通过进程间发送消息实现的，最基本的D-Bus协议是一对一的通信协议。与socket通信不同，D-Bus是面向消息的协议。但如果使用高层的绑定接口，不会直接接触到D-Bus的消息。<br><strong>D-Bus 有四种类型的消息：</strong></p>
<blockquote>
<p>A、method_call方法调用<br>B、method_return方法返回<br>C、error错误<br>D、signal信号</p>
</blockquote>
<p>代理中的远程对象调用涉及到了消息总线以及method_call和method_return两类消息。<br>消息有消息头(header)和消息体(body)。消息头包含消息体的路由信息，消息体是净荷，通常包含的是参数。消息头通常包含发送进程的连接名(Bus Name)、方法或者信号名等等，其中有一字段是用于描述消息体中的参数的类型的，例如“i”标识32位整数，“ii”表示2个32位整数。</p>
<h2 id="2、调用method的流程"><a href="#2、调用method的流程" class="headerlink" title="2、调用method的流程"></a>2、调用method的流程</h2><p>进程A要调用进程B的一个method，进程A发送method_call消息到进程B，进程B回复method_return消息。在发送消息时，发送方会在消息中添加不同的序列号，同样，回复消息中也会含有序列号，以便对应。</p>
<p><strong>调用method的流程如下：</strong></p>
<blockquote>
<p>A、在发送method_call消息时，如果使用了代理，进程A要调用进程B的某方法，不用构造method_call消息，只需调用代理的本地方法，代理会自动生成method_call消息发送到消息总线上。<br>B、如果使用底层API，进程A需要构造一个method_call消息。method_call消息包含对应进程B的连接名、方法名、方法所需参数、进程B中的对象路径和进程B中声明此方法的接口。<br>C、将method_call消息发送到消息总线上。<br>D、信息总线检查消息头中的目的连接名，当找到一个进程与此连接名对应时发送消息到该进程。当找不到一个进程与此连接名对应时，返回给进程A一个error消息。<br>E、进程B解析消息，如果是采用底层API方式，则直接调用方法，然后发宋应答消息到消息总线。如果是D-BUs高级API接口，会先检测对象路径、接口、方法名称，然后把消息转换成对应的本地对象（如GObject，QT中的QObject等）的方法，调用本地对象方法后再将应答结果转换成应答消息发给消息总线。<br>F、消息总线接收到method_return消息，将把method_return消息直接发给发出调用消息的进程。<br>消息总线不会对总线上的消息进行重排序。如果发送了两条消息到同一个进程，将按照发送顺序接	收到。接收进程不需要按照顺序发出应答消息，例如在多线程中处理这些消息，应答消息的发出是没有顺序的。消息都有一个序列号可以与应答消息进行配对。</p>
</blockquote>
<h2 id="3、发送signal的流程"><a href="#3、发送signal的流程" class="headerlink" title="3、发送signal的流程"></a>3、发送signal的流程</h2><p>发送信号是单向广播的，信号的发送者不知道对信号作响应的有哪些进程，所以信号发送是没有返回值的。信号接收者通过向消息总线注册匹配规则来表示对某信号感兴趣，而匹配规则通常包含信号的发出者和信号名。<br><strong>信号发送的流程如下：</strong></p>
<blockquote>
<p>A、当使用dbus底层接口时，信号需要应用进程自己创建和发送到消息总线；使用dbus高层API接口时，可以使用相关对象进行发送。信号消息包含有声明信号的接口名、信号名、所在进程对应的连接名和相关参数。<br>B、连接到消息总线上的进程如果对某个信号感兴趣，则注册相应的匹配规则。消息总线保持有匹配规则表。<br>C、消息总线根据匹配规则表，将信号发送到对信号感兴趣的进程。<br>D、每个进程收到信号后，如果使用dbus高级API接口，可以选择触发代理对象上的信号。如果使用dbus底层接口，需要检查发送者名称和信号名称，然后决定怎么做。</p>
</blockquote>
<h2 id="4、DBus工具"><a href="#4、DBus工具" class="headerlink" title="4、DBus工具"></a>4、DBus工具</h2><p>D-Bus提供了两个小工具：dbus-send 和dbus-monitor。可以用dbus-send发送消息，用dbus-monitor监视通道上流动的消息。</p>
<h3 id="dbus-send"><a href="#dbus-send" class="headerlink" title="dbus-send"></a>dbus-send</h3><p>用于发送一个消息到消息通道上，使用格式如下：</p>
<blockquote>
<p>dbus-send [–system | –session] –type&#x3D;TYPE –print-reply –dest&#x3D;连接名对象路径接口名.方法名参数类型:参数值参数类型:参数值<br>dbus-send –session –type&#x3D;method_call –print-reply –dest&#x3D;连接名对象路径接口名.方法名 参数类型:参数值 参数类型:参数值</p>
</blockquote>
<p>dbus-send支持的参数类型包括：string, int32, uint32, double, byte, boolean。</p>
<h3 id="dbus-monitor"><a href="#dbus-monitor" class="headerlink" title="dbus-monitor"></a>dbus-monitor</h3><p>用于打印消息通道上的消息，使用格式如下：</p>
<blockquote>
<p>dbus-monitor [–system | –session | –address ADDRESS] [–profile | –monitor] [watch expressions]<br>dbus-monitor “type&#x3D;’signal’, sender&#x3D;’org.gnome.TypingMonitor’, interface&#x3D;’org.gnome.TypingMonitor’”</p>
</blockquote>
<h2 id="5、消息总线上的方法和信号"><a href="#5、消息总线上的方法和信号" class="headerlink" title="5、消息总线上的方法和信号"></a>5、消息总线上的方法和信号</h2><p>消息总线是一个特殊的应用，主要关于消息总线上的方法和信号。</p>
<h3 id="A、Introspection"><a href="#A、Introspection" class="headerlink" title="A、Introspection"></a>A、Introspection</h3><blockquote>
<p>消息总线上有一个接口org.freedesktop.DBus.Introspectable，接口中声明了一个方法Introspect，不带参数，将返回一个XML string，XML字符串描述接口、方法、信号。</p>
</blockquote>
<h3 id="B、消息总线上的方法和信号"><a href="#B、消息总线上的方法和信号" class="headerlink" title="B、消息总线上的方法和信号"></a>B、消息总线上的方法和信号</h3><p>可以通过向名称为“org.freedesktop.DBus”的连接上的对象“&#x2F;”发送消息来调用消息总线提供的方法。消息总线对象支持标准接口”org.freedesktop.DBus.Introspectable”，可以调用org.freedesktop.DBus.Introspectable.Introspect方法查看消息总线对象支持的接口。</p>
<blockquote>
<p>dbus-send –session –type&#x3D;method_call –print-reply –dest&#x3D;org.freedesktop.DBus &#x2F; org.freedesktop.DBus.Introspectable.Introspect</p>
</blockquote>
<p>用户总线对象支持标准接口“org.freedesktop.DBus.Introspectable”和接口“org.freedesktop.DBus”。<br>接口“org.freedesktop.DBus”有18个方法和3个信号。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;interface name=<span class="string">&quot;org.freedesktop.DBus&quot;</span>&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;Hello&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;RequestName&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;ReleaseName&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;StartServiceByName&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;UpdateActivationEnvironment&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;a&#123;ss&#125;&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;NameHasOwner&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;b&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;ListNames&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;as&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;ListActivatableNames&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;as&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;AddMatch&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;RemoveMatch&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;GetNameOwner&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;ListQueuedOwners&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;as&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;GetConnectionUnixUser&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;GetConnectionUnixProcessID&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;u&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;GetAdtAuditSessionData&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;ay&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;GetConnectionSELinuxSecurityContext&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;in&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;ay&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;ReloadConfig&quot;</span>&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;GetId&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">  &lt;signal name=<span class="string">&quot;NameOwnerChanged&quot;</span>&gt;</span><br><span class="line">    &lt;arg type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">    &lt;arg type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/signal&gt;</span><br><span class="line">  &lt;signal name=<span class="string">&quot;NameLost&quot;</span>&gt;</span><br><span class="line">    &lt;arg type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/signal&gt;</span><br><span class="line">  &lt;signal name=<span class="string">&quot;NameAcquired&quot;</span>&gt;</span><br><span class="line">    &lt;arg type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/signal&gt;</span><br><span class="line">&lt;/interface&gt;</span><br><span class="line">&lt;interface name=<span class="string">&quot;org.freedesktop.DBus.Introspectable&quot;</span>&gt;</span><br><span class="line">  &lt;method name=<span class="string">&quot;Introspect&quot;</span>&gt;</span><br><span class="line">    &lt;arg direction=<span class="string">&quot;out&quot;</span> type=<span class="string">&quot;s&quot;</span>/&gt;</span><br><span class="line">  &lt;/method&gt;</span><br><span class="line">&lt;/interface&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







</div><div class="article-licensing box"><div class="licensing-title"><p>D-Bus_介绍&amp;工具使用</p><p><a href="http://example.com/2023/12/01/D-Bus 介绍&amp;工具使用/">http://example.com/2023/12/01/D-Bus 介绍&amp;工具使用/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>lx</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2023-12-01</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2023-12-01</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/12/01/bootchart%E4%BD%BF%E7%94%A8%E6%89%8B%E9%A1%BA/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">BootChart使用手顺</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/11/30/ANDROID%20property%20%E5%8F%82%E6%95%B0%E7%AE%80%E4%BB%8B/"><span class="level-item">Android Property参数简介</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn.jsdelivr.net/npm/leancloud-storage@3/dist/av-min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/valine/1.4.16/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread',
            appId: "dB8Dj4QSAc3XtpuM6sS4fCKR-gzGzoHsz",
            appKey: "xrxrySOXhneb2IHjGP1lHSx3",
            
            avatar: "mm",
            avatarForce: false,
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "zh-CN",
            visitor: false,
            highlight: true,
            recordIP: false,
            
            
            
            enableQQ: false,
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/logo.png" alt="XinCm"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">XinCm</p><p class="is-size-6 is-block">Just Do it</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>JiangSu</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">21</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/XinCm" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/XinCm"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Android%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">Android技术</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/C/"><span class="level-start"><span class="level-item">C++</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">开发工具</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%96%87%E7%AB%A0%E5%88%86%E4%BA%AB/"><span class="level-start"><span class="level-item">文章分享</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AF%BB%E4%B9%A6/"><span class="level-start"><span class="level-item">读书</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-15T05:03:20.843Z">2024-01-15</time></p><p class="title"><a href="/2024/01/15/C++%E7%9A%84%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92/">C++的参数传递</a></p><p class="categories"><a href="/categories/C/">C++</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-11T16:00:00.000Z">2024-01-12</time></p><p class="title"><a href="/2024/01/12/%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E4%B8%8E%E5%9D%97%E8%AE%BE%E5%A4%87/">字符设备与块设备的区别</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-08T16:00:00.000Z">2024-01-09</time></p><p class="title"><a href="/2024/01/09/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90/">内存对齐</a></p><p class="categories"><a href="/categories/Linux/">Linux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-05T07:30:13.301Z">2024-01-05</time></p><p class="title"><a href="/2024/01/05/git/">GIT</a></p><p class="categories"><a href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-01-04T07:53:59.712Z">2024-01-04</time></p><p class="title"><a href="/2024/01/04/device.mk/">android 下device.mk</a></p><p class="categories"><a href="/categories/Android%E6%8A%80%E6%9C%AF/">Android技术</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">一月 2024</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">十二月 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/11/"><span class="level-start"><span class="level-item">十一月 2023</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li></ul></div></div></div><!--!--><!--!--><!--!--><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="XinCm" height="28"></a><p class="is-size-7"><span>&copy; 2024 lx</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p><p class="is-size-7">© 2019</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/XinCm"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>